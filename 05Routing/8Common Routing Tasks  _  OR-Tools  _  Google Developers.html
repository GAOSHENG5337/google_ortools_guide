<!DOCTYPE html>
<!-- saved from url=(0063)https://developers.google.cn/optimization/routing/routing_tasks -->
<html lang="en" class="" ml-update="aware"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript" async="" src="./Common Routing Tasks  _  OR-Tools  _  Google Developers_files/linkid.js"></script><script async="" src="./Common Routing Tasks  _  OR-Tools  _  Google Developers_files/analytics.js"></script><script>var a=window.devsite||{};window.devsite=a;a.readyCallbacks=[];window.devsite.readyCallbacks=a.readyCallbacks;a.ready=function(b){a.readyCallbacks.push(b)};window.devsite.ready=a.ready;
</script><meta name="xsrf_token" content="J0k62jC2iWiHB1chuI9-t3DpWOvVS1U_pCZM7TLQB2o6MTU0NzAxNDIxNDg4NjU4MQ"><link rel="canonical" href="https://developers.google.com/optimization/routing/routing_tasks"><link rel="alternate" href="https://developers.google.com/optimization/routing/routing_tasks" hreflang="en"><link rel="alternate" href="https://developers.google.cn/optimization/routing/routing_tasks" hreflang="en-cn"><link rel="alternate" href="https://developers.google.com/optimization/routing/routing_tasks" hreflang="x-default"><link rel="shortcut icon" href="https://developers.google.cn/_static/0ee1984e83/images/favicon.png"><link rel="apple-touch-icon" href="https://developers.google.cn/_static/0ee1984e83/images/touch-icon.png"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="./Common Routing Tasks  _  OR-Tools  _  Google Developers_files/css"><link rel="stylesheet" href="./Common Routing Tasks  _  OR-Tools  _  Google Developers_files/devsite-google-blue.css"><script src="./Common Routing Tasks  _  OR-Tools  _  Google Developers_files/jquery-bundle.js"></script><meta property="og:site_name" content="Google Developers"><meta property="og:type" content="website"><meta property="og:url" content="https://developers.google.com/optimization/routing/routing_tasks"><meta property="og:locale" content="en"><script>
    var ___gcfg = ___gcfg || {};
    ___gcfg.lang = 'zh-cn';
  </script><title>Common Routing Tasks &nbsp;|&nbsp; OR-Tools
      &nbsp;|&nbsp; Google Developers</title><meta property="og:title" content="Common Routing Tasks  |  OR-Tools
       |  Google Developers"></head><body class="devsite-doc-page devsite-header-no-upper-tabs no-touch" data-family="endorsed" id="top_of_page"><div class="devsite-wrapper" style="margin-top: 0px;"><div class="devsite-top-section-wrapper
            "><header class="devsite-top-section nocontent devsite-top-section-pinned"><div class="devsite-top-logo-row-wrapper-wrapper" style="position: relative;"><div class="devsite-top-logo-row-wrapper"><div class="devsite-top-logo-row devsite-full-site-width"><button type="button" class="devsite-expand-section-nav devsite-header-icon-button
                                       button-flat material-icons gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Hamburger menu"></button><div class="devsite-product-name-wrapper"><a class="devsite-product-name-link gc-analytics-event" href="https://developers.google.cn/optimization/" data-category="Site-Wide Custom Events" data-label="Project logo (header)"><img src="./Common Routing Tasks  _  OR-Tools  _  Google Developers_files/orLogo.png" class="devsite-product-logo" alt="Google OR-Tools"></a><span class="devsite-product-name"><ul class="devsite-breadcrumb-list"><li class="devsite-breadcrumb-item"><a href="https://developers.google.cn/optimization/" class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Upper Header" data-value="1">
    
    
      
        Google OR-Tools
      
    
    
    </a></li></ul></span></div><div class="devsite-header-upper-tabs"></div><form class="devsite-search-form" action="https://developers.google.cn/s/results/" method="GET" id="top-search" search-placeholder="搜索"><div id="searchbox" class="devsite-searchbox"><input placeholder="搜索" type="text" class="devsite-search-field devsite-search-query" name="q" value="" autocomplete="off" aria-label="搜索框"><div class="devsite-search-image material-icons"></div></div><input type="hidden" name="p" id="search_project" value="/optimization/" data-project-name="OR-Tools" data-project-path="/optimization/" data-query-match=""><input type="hidden" class="suggest-project" value="OR-Tools"><div class="suggest-project-metadata" data-home_url="/optimization/" data-path="/optimization/" data-name="OR-Tools"></div><div class="devsite-popout devsite-popout-closed"><div class="devsite-suggest-results" style="display: none;"></div></div></form><a class="devsite-header-link devsite-top-button button gc-analytics-event" href="https://developers.google.cn/products/" data-category="Site-Wide Custom Events" data-label="Site header link" track-type="globalNav" track-name="所有产品" track-metadata-position="nav" track-metadata-eventdetail="nav"><div class="devsite-header-link-icon material-icons">
                  list
                </div><div class="devsite-header-link-label">所有产品</div></a><button type="button" class="devsite-search-button devsite-header-icon-button button-flat
                                       material-icons"></button></div></div></div><div class="devsite-collapsible-section" style="margin-top: 0px;"><div class="devsite-header-background devsite-full-site-width"><div class="devsite-doc-set-nav-row devsite-full-site-width"><nav class="devsite-doc-set-nav devsite-nav devsite-overflow-tabs-scroll-wrapper"><ul class="devsite-doc-set-nav-tab-list devsite-overflow-tabs-scroll" style="min-width: 550px; left: 0px;"><li class="devsite-doc-set-nav-tab-container devsite-nav-tab
                 "><a href="https://developers.google.cn/optimization/" class=" devsite-nav-tab
                  devsite-doc-set-nav-tab devsite-doc-set-nav-tab-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Tab: 首页">
          首页
        </a></li><li class="devsite-doc-set-nav-tab-container devsite-nav-tab
                 "><a href="https://developers.google.cn/optimization/install" class=" devsite-nav-tab
                  devsite-doc-set-nav-tab devsite-doc-set-nav-tab-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Tab: Installation">
          Installation
        </a></li><li class="devsite-doc-set-nav-tab-container devsite-nav-tab
                 "><a href="https://developers.google.cn/optimization/introduction/overview" class="devsite-doc-set-nav-active devsite-nav-tab
                  devsite-doc-set-nav-tab devsite-doc-set-nav-tab-link gc-analytics-event" aria-label="Guides, selected" data-category="Site-Wide Custom Events" data-label="Tab: Guides">
          Guides
        </a></li><li class="devsite-doc-set-nav-tab-container devsite-nav-tab
                 "><a href="https://developers.google.cn/optimization/reference" class=" devsite-nav-tab
                  devsite-doc-set-nav-tab devsite-doc-set-nav-tab-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Tab: Reference">
          Reference
        </a></li><li class="devsite-doc-set-nav-tab-container devsite-nav-tab
                 "><a href="https://developers.google.cn/optimization/support/overview" class=" devsite-nav-tab
                  devsite-doc-set-nav-tab devsite-doc-set-nav-tab-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Tab: Support">
          Support
        </a></li></ul><button type="button" class="devsite-overflow-tabs-scroll-button devsite-top-button material-icons devsite-scroll-forward devsite-hidden" aria-label="滚动标签"></button><button type="button" class="devsite-overflow-tabs-scroll-button devsite-top-button material-icons devsite-scroll-back devsite-hidden" aria-label="滚动标签"></button></nav></div></div></div></header><script>
    if (window.jQuery) {
      $(document).ready(function() {
        if (window.devsite && window.devsite.search) {
          
          window.devsite.search.init('zh-cn')
        }
      });
    }
  </script></div><div id="gc-wrapper" itemscope="" itemtype="http://schema.org/Article"><input class="google-analytics-id-json" type="hidden" value="{&quot;dimensions&quot;: {}, &quot;gaid&quot;: &quot;UA-10115507-7&quot;}"><input class="google-analytics-id-json" type="hidden" value="{&quot;dimensions&quot;: {&quot;dimension6&quot;: &quot;en&quot;, &quot;dimension4&quot;: &quot;OR-Tools&quot;, &quot;dimension5&quot;: &quot;zh-cn&quot;, &quot;dimension3&quot;: false, &quot;dimension1&quot;: &quot;Signed out&quot;, &quot;dimension8&quot;: null}, &quot;gaid&quot;: &quot;UA-24532603-11&quot;}"><script>
      var dataLayer = [{"freeTrialEligibleUser": "False", "userCountry": "CN", "language": {"requested": "zh-cn", "served": "en"}, "projectName": "OR-Tools", "scriptsafe": null, "signedIn": "False", "internalUser": "False"}];
    </script>

      
        <div class="devsite-site-mask"></div>
        
  


<nav class="devsite-nav-responsive devsite-nav nocontent" tabindex="0" style="left: -256px;">
  
  <div class="devsite-nav-responsive-tabs-panel devsite-nav-responsive-transition devsite-nav-responsive-transform" style="display: none;">
    
      



<nav class="devsite-nav-responsive-tabs devsite-nav">
  <ul class="devsite-nav-list">
  

  
    <li class="devsite-nav-item devsite-nav-item-heading">
      
        <a href="https://developers.google.cn/optimization/" class="devsite-nav-responsive-tab devsite-nav-title gc-analytics-event
                  " data-category="Site-Wide Custom Events" data-label="Responsive Tab: 首页"><span>
          首页
        </span></a>
      

      

      

      
    </li>
  
    <li class="devsite-nav-item devsite-nav-item-heading">
      
        <a href="https://developers.google.cn/optimization/install?nav=true" class="devsite-nav-responsive-tab devsite-nav-title gc-analytics-event
                  " data-category="Site-Wide Custom Events" data-label="Responsive Tab: Installation"><span>
          Installation
        </span></a>
      

      

      

      
    </li>
  
    <li class="devsite-nav-item devsite-nav-item-heading">
      
        <span class="devsite-nav-responsive-forward devsite-nav-responsive-tab devsite-nav-title
                     devsite-nav-active gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Responsive Tab: Guides" tabindex="0"><span>
          Guides
        </span></span>
      

      

      

      
    </li>
  
    <li class="devsite-nav-item devsite-nav-item-heading">
      
        <a href="https://developers.google.cn/optimization/reference" class="devsite-nav-responsive-tab devsite-nav-title gc-analytics-event
                  " data-category="Site-Wide Custom Events" data-label="Responsive Tab: Reference"><span>
          Reference
        </span></a>
      

      

      

      
    </li>
  
    <li class="devsite-nav-item devsite-nav-item-heading">
      
        <a href="https://developers.google.cn/optimization/support/overview?nav=true" class="devsite-nav-responsive-tab devsite-nav-title gc-analytics-event
                  " data-category="Site-Wide Custom Events" data-label="Responsive Tab: Support"><span>
          Support
        </span></a>
      

      

      

      
    </li>
  

  
    <li class="devsite-nav-item devsite-nav-item-heading">
      <a href="https://developers.google.cn/products/" class="devsite-nav-responsive-tab devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Responsive Tab: all_products"><span>
        所有产品
      </span></a>
    </li>
  
  </ul>
</nav>


    
  </div>
  
  
  <div class="devsite-nav-responsive-sidebar-panel" style="display: block;">
    
    <div class="devsite-nav-responsive-back" tabindex="0"></div>
    
    <nav class="devsite-nav-responsive-sidebar">
      
      
    <ul class="devsite-nav-list devsite-nav-expandable devsite-nav-only-accordions"><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Introduction, click to expand/collapse" role="link" tabindex="0"><span>Introduction</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/introduction/overview" class="devsite-nav-title"><span>About Combinatorial Optimization</span></a></li><li class="devsite-nav-item devsite-nav-item-section-expandable"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Get Started with OR-Tools, click to expand/collapse" role="link" tabindex="0"><span>Get Started with OR-Tools</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="1" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/introduction/get_started" class="devsite-nav-title"><span>概览</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/introduction/cpp" class="devsite-nav-title"><span>C++</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/introduction/python" class="devsite-nav-title"><span>Python</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/introduction/java" class="devsite-nav-title"><span>Java</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/introduction/cs" class="devsite-nav-title"><span>C#</span></a></li></ul></li></ul></li><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Linear Optimization, click to expand/collapse" role="link" tabindex="0"><span>Linear Optimization</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/lp" class="devsite-nav-title"><span>Overview</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/lp/glop" class="devsite-nav-title"><span>The Glop Linear Solver</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/lp/add-on" class="devsite-nav-title"><span>Add-on for Google Sheets</span></a></li><li class="devsite-nav-item devsite-nav-external devsite-nav-has-status"><a href="https://developers.google.cn/apps-script/reference/optimization" class="devsite-nav-title"><span class="devsite-nav-text"><span>Service for Apps Script</span></span><span class="devsite-nav-icon-wrapper"><span class="devsite-nav-icon material-icons" data-tooltip-align="b,c" data-tooltip="外部" aria-label="外部" data-title="外部"></span></span></a></li></ul></li><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Constraint Optimization, click to expand/collapse" role="link" tabindex="0"><span>Constraint Optimization</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/cp" class="devsite-nav-title"><span>Overview</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/cp/cp_solver" class="devsite-nav-title"><span>CP-SAT Solver</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/cp/original_cp_solver" class="devsite-nav-title"><span>Original CP Solver</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/cp/cryptarithmetic" class="devsite-nav-title"><span>Cryptarithmetic</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/cp/queens" class="devsite-nav-title"><span>The N-queens Problem</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/cp/cp_tasks" class="devsite-nav-title"><span>Setting Solver Limits</span></a></li></ul></li><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Integer Optimization, click to expand/collapse" role="link" tabindex="0"><span>Integer Optimization</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/mip" class="devsite-nav-title"><span>Overview</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/mip/integer_opt" class="devsite-nav-title"><span>Mixed-Integer Programming</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/mip/integer_opt_cp" class="devsite-nav-title"><span>CP Approach to Integer Optimization</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/mip/sudoku" class="devsite-nav-title"><span>Sudoku Add-on for Google Sheets</span></a></li></ul></li><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Routing, click to expand/collapse" role="link" tabindex="0"><span>Routing</span></span><a class="devsite-nav-toggle devsite-nav-toggle-expanded material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0"></a><ul class="devsite-nav-section devsite-nav-section-expanded"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing" class="devsite-nav-title"><span>Overview</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/tsp" class="devsite-nav-title"><span>Traveling Salesman Problem</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/vrp" class="devsite-nav-title"><span>Vehicle Routing Problem</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/cvrp" class="devsite-nav-title"><span>Capacity Constraints</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/cvrptw" class="devsite-nav-title"><span>Time Window Constraints</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/cvrptw_resources" class="devsite-nav-title"><span>Resource Constraints</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/penalties" class="devsite-nav-title" data-tooltip-align="b,c" data-tooltip="Dropping Visits in Infeasible Problems-Penalties" aria-label="Dropping Visits in Infeasible Problems-Penalties" data-title="Dropping Visits in Infeasible Problems-Penalties"><span>Dropping Visits in Infeasible Problems-Penalties</span></a></li><li class="devsite-nav-item devsite-nav-active"><a href="https://developers.google.cn/optimization/routing/routing_tasks" class="devsite-nav-title"><span>Common Vehicle Routing Tasks</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/routing_options" class="devsite-nav-title"><span>Routing Options</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/google_direction" class="devsite-nav-title"><span>Google Direction API</span></a></li></ul></li><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Bin Packing, click to expand/collapse" role="link" tabindex="0"><span>Bin Packing</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/bin" class="devsite-nav-title"><span>Overview</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/bin/knapsack" class="devsite-nav-title"><span>Knapsacks</span></a></li></ul></li><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Network Flows, click to expand/collapse" role="link" tabindex="0"><span>Network Flows</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/flow" class="devsite-nav-title"><span>Overview</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/flow/maxflow" class="devsite-nav-title"><span>Maximum Flows</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/flow/mincostflow" class="devsite-nav-title"><span>Minimum Cost Flows</span></a></li></ul></li><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Assignment, click to expand/collapse" role="link" tabindex="0"><span>Assignment</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/assignment/simple_assignment" class="devsite-nav-title"><span>Overview</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/assignment/assignment_min_cost_flow" class="devsite-nav-title"><span>Assignment as a Min Cost Flow Problem</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/assignment/assignment_mip" class="devsite-nav-title"><span>Assignment as a MIP Problem</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/assignment/assignment_cp" class="devsite-nav-title"><span>Assignment with Task Sizes</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/assignment/assignment_groups" class="devsite-nav-title"><span>Assignment with Allowed Groups</span></a></li></ul></li><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Scheduling, click to expand/collapse" role="link" tabindex="0"><span>Scheduling</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/scheduling" class="devsite-nav-title"><span>Overview</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/scheduling/employee_scheduling" class="devsite-nav-title"><span>Employee Scheduling</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/scheduling/job_shop" class="devsite-nav-title"><span>The Job Shop Problem</span></a></li></ul></li></ul></nav>
  </div>
  
  
</nav>


        <div class="devsite-main-content clearfix" style="margin-top: 136px;">

        
        

        
  
  
    
    
      
  <nav class="devsite-section-nav devsite-nav nocontent" style="left: auto; max-height: 544px; position: relative; top: 0px;">
    <ul class="devsite-nav-list devsite-nav-expandable devsite-nav-only-accordions"><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Introduction, click to expand/collapse" role="link" tabindex="0"><span>Introduction</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/introduction/overview" class="devsite-nav-title"><span>About Combinatorial Optimization</span></a></li><li class="devsite-nav-item devsite-nav-item-section-expandable"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Get Started with OR-Tools, click to expand/collapse" role="link" tabindex="0"><span>Get Started with OR-Tools</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="1" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/introduction/get_started" class="devsite-nav-title"><span>概览</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/introduction/cpp" class="devsite-nav-title"><span>C++</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/introduction/python" class="devsite-nav-title"><span>Python</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/introduction/java" class="devsite-nav-title"><span>Java</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/introduction/cs" class="devsite-nav-title"><span>C#</span></a></li></ul></li></ul></li><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Linear Optimization, click to expand/collapse" role="link" tabindex="0"><span>Linear Optimization</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/lp" class="devsite-nav-title"><span>Overview</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/lp/glop" class="devsite-nav-title"><span>The Glop Linear Solver</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/lp/add-on" class="devsite-nav-title"><span>Add-on for Google Sheets</span></a></li><li class="devsite-nav-item devsite-nav-external devsite-nav-has-status"><a href="https://developers.google.cn/apps-script/reference/optimization" class="devsite-nav-title"><span class="devsite-nav-text"><span>Service for Apps Script</span></span><span class="devsite-nav-icon-wrapper"><span class="devsite-nav-icon material-icons" data-tooltip-align="b,c" data-tooltip="外部" aria-label="外部" data-title="外部"></span></span></a></li></ul></li><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Constraint Optimization, click to expand/collapse" role="link" tabindex="0"><span>Constraint Optimization</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/cp" class="devsite-nav-title"><span>Overview</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/cp/cp_solver" class="devsite-nav-title"><span>CP-SAT Solver</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/cp/original_cp_solver" class="devsite-nav-title"><span>Original CP Solver</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/cp/cryptarithmetic" class="devsite-nav-title"><span>Cryptarithmetic</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/cp/queens" class="devsite-nav-title"><span>The N-queens Problem</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/cp/cp_tasks" class="devsite-nav-title"><span>Setting Solver Limits</span></a></li></ul></li><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Integer Optimization, click to expand/collapse" role="link" tabindex="0"><span>Integer Optimization</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/mip" class="devsite-nav-title"><span>Overview</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/mip/integer_opt" class="devsite-nav-title"><span>Mixed-Integer Programming</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/mip/integer_opt_cp" class="devsite-nav-title"><span>CP Approach to Integer Optimization</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/mip/sudoku" class="devsite-nav-title"><span>Sudoku Add-on for Google Sheets</span></a></li></ul></li><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Routing, click to expand/collapse" role="link" tabindex="0"><span>Routing</span></span><a class="devsite-nav-toggle devsite-nav-toggle-expanded material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0"></a><ul class="devsite-nav-section devsite-nav-section-expanded"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing" class="devsite-nav-title"><span>Overview</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/tsp" class="devsite-nav-title"><span>Traveling Salesman Problem</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/vrp" class="devsite-nav-title"><span>Vehicle Routing Problem</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/cvrp" class="devsite-nav-title"><span>Capacity Constraints</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/cvrptw" class="devsite-nav-title"><span>Time Window Constraints</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/cvrptw_resources" class="devsite-nav-title"><span>Resource Constraints</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/penalties" class="devsite-nav-title"><span>Dropping Visits in Infeasible Problems-Penalties</span></a></li><li class="devsite-nav-item devsite-nav-active"><a href="https://developers.google.cn/optimization/routing/routing_tasks" class="devsite-nav-title"><span>Common Vehicle Routing Tasks</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/routing_options" class="devsite-nav-title"><span>Routing Options</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/google_direction" class="devsite-nav-title"><span>Google Direction API</span></a></li></ul></li><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Bin Packing, click to expand/collapse" role="link" tabindex="0"><span>Bin Packing</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/bin" class="devsite-nav-title"><span>Overview</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/bin/knapsack" class="devsite-nav-title"><span>Knapsacks</span></a></li></ul></li><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Network Flows, click to expand/collapse" role="link" tabindex="0"><span>Network Flows</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/flow" class="devsite-nav-title"><span>Overview</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/flow/maxflow" class="devsite-nav-title"><span>Maximum Flows</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/flow/mincostflow" class="devsite-nav-title"><span>Minimum Cost Flows</span></a></li></ul></li><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Assignment, click to expand/collapse" role="link" tabindex="0"><span>Assignment</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/assignment/simple_assignment" class="devsite-nav-title"><span>Overview</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/assignment/assignment_min_cost_flow" class="devsite-nav-title"><span>Assignment as a Min Cost Flow Problem</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/assignment/assignment_mip" class="devsite-nav-title"><span>Assignment as a MIP Problem</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/assignment/assignment_cp" class="devsite-nav-title"><span>Assignment with Task Sizes</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/assignment/assignment_groups" class="devsite-nav-title"><span>Assignment with Allowed Groups</span></a></li></ul></li><li class="devsite-nav-item devsite-nav-item-section-expandable devsite-nav-accordion"><span class="devsite-nav-title devsite-nav-title-no-path" aria-label="Scheduling, click to expand/collapse" role="link" tabindex="0"><span>Scheduling</span></span><a class="devsite-nav-toggle devsite-nav-toggle-collapsed material-icons" track-type="leftNav" track-name="expandNavSectionArrow" track-metadata-position="0" aria-hidden="true"></a><ul class="devsite-nav-section devsite-nav-section-collapsed"><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/scheduling" class="devsite-nav-title"><span>Overview</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/scheduling/employee_scheduling" class="devsite-nav-title"><span>Employee Scheduling</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/scheduling/job_shop" class="devsite-nav-title"><span>The Job Shop Problem</span></a></li></ul></li></ul>
  </nav>

    

    
  <nav class="devsite-page-nav devsite-nav" style="position: relative; left: auto; max-height: 544px; top: 0px;"><ul class="devsite-page-nav-list"><li class="devsite-nav-item devsite-nav-item-heading"><a href="https://developers.google.cn/optimization/routing/routing_tasks#top_of_page" class="devsite-nav-title"><span>目录</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/routing_tasks#search-limits" class="devsite-nav-title"><span>Search limits</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/routing_tasks#storing-solutions-in-an-array" class="devsite-nav-title"><span>Storing solutions in an array</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/routing_tasks#setting-initial-routes-for-a-search" class="devsite-nav-title"><span>Setting initial routes for a search</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/routing_tasks#setting-start-and-end-locations-for-routes" class="devsite-nav-title"><span>Setting start and end locations for routes</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/routing_tasks#allowing-arbitrary-start-and-end-locations" class="devsite-nav-title"><span>Allowing arbitrary start and end locations</span></a></li></ul></nav>


      <article class="devsite-article">
        <article class="devsite-article-inner">
  
          
  


<div class="devsite-rating-container
            "><div class="devsite-rating-stars"><div class="devsite-rating-star devsite-rating-star-outline gc-analytics-event material-icons" data-rating-val="1" data-category="Site-Wide Custom Events" data-label="Star Rating 1" track-metadata-score="1" track-type="feedback" track-name="rating" track-metadata-position="header" role="button" aria-label="网站内容评分：1 星（最高 5 星）"></div><div class="devsite-rating-star devsite-rating-star-outline gc-analytics-event material-icons" data-rating-val="2" data-category="Site-Wide Custom Events" data-label="Star Rating 2" track-metadata-score="2" track-type="feedback" track-name="rating" track-metadata-position="header" role="button" aria-label="网站内容评分：2 星（最高 5 星）"></div><div class="devsite-rating-star devsite-rating-star-outline gc-analytics-event material-icons" data-rating-val="3" data-category="Site-Wide Custom Events" data-label="Star Rating 3" track-metadata-score="3" track-type="feedback" track-name="rating" track-metadata-position="header" role="button" aria-label="网站内容评分：3 星（最高 5 星）"></div><div class="devsite-rating-star devsite-rating-star-outline gc-analytics-event material-icons" data-rating-val="4" data-category="Site-Wide Custom Events" data-label="Star Rating 4" track-metadata-score="4" track-type="feedback" track-name="rating" track-metadata-position="header" role="button" aria-label="网站内容评分：4 星（最高 5 星）"></div><div class="devsite-rating-star devsite-rating-star-outline gc-analytics-event material-icons" data-rating-val="5" data-category="Site-Wide Custom Events" data-label="Star Rating 5" track-metadata-score="5" track-type="feedback" track-name="rating" track-metadata-position="header" role="button" aria-label="网站内容评分：5 星（最高 5 星）"></div></div><div class="devsite-rating-description"></div><div class="devsite-rating-internal"><span class="devsite-rating-stats"></span></div></div><script>
  $(document).ready(function() {
    devsite.ratings.init(
      document.querySelectorAll('#devsite-feedback-project'), false
      
    );
  });
</script>


  
  <nav class="devsite-breadcrumb-nav devsite-nav">
    


<ul class="devsite-breadcrumb-list">
  
  <li class="devsite-breadcrumb-item">
    
    
    <a href="https://developers.google.cn/products/" class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="1">
    
    
      产品
    
    
    </a>
    
  </li>
  
  <li class="devsite-breadcrumb-item">
    
    
    <div class="devsite-breadcrumb-guillemet material-icons"></div>
    
    
    <a href="https://developers.google.cn/optimization/" class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="2">
    
    
      OR-Tools
    
    
    </a>
    
  </li>
  
  <li class="devsite-breadcrumb-item">
    
    
    <div class="devsite-breadcrumb-guillemet material-icons"></div>
    
    
    <a href="https://developers.google.cn/optimization/introduction/overview" class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="3">
    
    
      Guides
    
    
    </a>
    
  </li>
  
</ul>

  </nav>
  
  
  <h1 itemprop="name" class="devsite-page-title">
    Common Routing Tasks
  </h1>
  
  
  <nav class="devsite-page-nav-embedded devsite-nav"><ul class="devsite-page-nav-list"><li class="devsite-nav-item devsite-nav-item-heading"><a href="https://developers.google.cn/optimization/routing/routing_tasks#top_of_page" class="devsite-nav-title"><span>目录</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/routing_tasks#search-limits" class="devsite-nav-title"><span>Search limits</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/routing_tasks#storing-solutions-in-an-array" class="devsite-nav-title"><span>Storing solutions in an array</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/routing_tasks#setting-initial-routes-for-a-search" class="devsite-nav-title"><span>Setting initial routes for a search</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/routing_tasks#setting-start-and-end-locations-for-routes" class="devsite-nav-title"><span>Setting start and end locations for routes</span></a></li><li class="devsite-nav-item"><a href="https://developers.google.cn/optimization/routing/routing_tasks#allowing-arbitrary-start-and-end-locations" class="devsite-nav-title"><span>Allowing arbitrary start and end locations</span></a></li></ul></nav>
  
  <div class="devsite-article-body clearfix
            " itemprop="articleBody">
    

<p>The following sections explain how to do some common tasks related to
solving vehicle routing problems.</p>

<h2 id="search-limits"><a href="https://developers.google.cn/optimization/routing/routing_tasks#top_of_page" class="devsite-back-to-top-link material-icons" data-tooltip-align="b,c" data-tooltip="返回页首" aria-label="返回页首" data-title="返回页首"></a>Search limits</h2>
<p>Vehicle routing problems with many locations
can take a long time to solve. For such problems, it is a good idea to
set a search limit, which terminates the search after a specified length of time
or number of solutions returned. When the solver reaches the limit,
you can save the latest solution to a file. If later you want to try to find a better solution,
you can restart the search, using the saved solution as an initial point.</p>

<p>To set a time limit for a search, add the following search
parameter before the call to the solver.</p>
<pre class="prettyprint lang-python"><div class="devsite-code-button-wrapper"><div class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="深色代码主题" aria-label="深色代码主题" data-title="深色代码主题"></div><div class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="点击复制" aria-label="点击复制" data-title="点击复制"></div></div><span class="pln">search_parameters</span><span class="pun">.</span><span class="pln">time_limit_ms </span><span class="pun">=</span><span class="pln"> </span><span class="lit">30000</span></pre>
<p>This stops the search after 30000 milliseconds (or 30 seconds). See
<a href="https://developers.google.cn/optimization/routing/tsp#changing-the-search-strategy">Changing the search
strategy</a> for a complete example with a time limit.</p>
<p>To set a limit on the number of solutions returned, add the following.</p>
<pre class="prettyprint lang-python"><div class="devsite-code-button-wrapper"><div class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="深色代码主题" aria-label="深色代码主题" data-title="深色代码主题"></div><div class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="点击复制" aria-label="点击复制" data-title="点击复制"></div></div><span class="pln">search_parameters</span><span class="pun">.</span><span class="pln">solution_limit </span><span class="pun">=</span><span class="pln"> </span><span class="lit">100</span></pre>

<h2 id="storing-solutions-in-an-array"><a href="https://developers.google.cn/optimization/routing/routing_tasks#top_of_page" class="devsite-back-to-top-link material-icons" data-tooltip-align="b,c" data-tooltip="返回页首" aria-label="返回页首" data-title="返回页首"></a>Storing solutions in an array</h2>
<p>At times you may find it convenient to store the routes in a VRP solution in an array.
For example, you might
want to perform multiple searches, using different parameters, and then
compare the saved results. </p>
<p>The following Python function gets the routes from a solution and saves them in an array.</p>
<pre class="prettyprint lang-python"><div class="devsite-code-button-wrapper"><div class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="深色代码主题" aria-label="深色代码主题" data-title="深色代码主题"></div><div class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="点击复制" aria-label="点击复制" data-title="点击复制"></div></div><span class="kwd">def</span><span class="pln"> get_routes_array</span><span class="pun">(</span><span class="pln">assignment</span><span class="pun">,</span><span class="pln"> num_vehicles</span><span class="pun">,</span><span class="pln"> routing</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="com"># Get the routes for an assignent and return as a list of lists.</span><span class="pln"><br>&nbsp; routes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln"><br>&nbsp; </span><span class="kwd">for</span><span class="pln"> route_nbr </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">num_vehicles</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; node </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">Start</span><span class="pun">(</span><span class="pln">route_nbr</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; route </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">while</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IsEnd</span><span class="pun">(</span><span class="pln">node</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; index </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">NodeToIndex</span><span class="pun">(</span><span class="pln">node</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; route</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; node </span><span class="pun">=</span><span class="pln"> assignment</span><span class="pun">.</span><span class="typ">Value</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">.</span><span class="typ">NextVar</span><span class="pun">(</span><span class="pln">node</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; routes</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">route</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="kwd">return</span><span class="pln"> routes</span></pre>

<p>You can add this function to a Python program for a VRP,
and call it as follows:</p>
<pre class="prettyprint lang-python"><div class="devsite-code-button-wrapper"><div class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="深色代码主题" aria-label="深色代码主题" data-title="深色代码主题"></div><div class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="点击复制" aria-label="点击复制" data-title="点击复制"></div></div><span class="pln">assignment </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">SolveWithParameters</span><span class="pun">(</span><span class="pln">search_parameters</span><span class="pun">)</span><span class="pln"><br>routes </span><span class="pun">=</span><span class="pln"> get_routes_array</span><span class="pun">(</span><span class="pln">assignment</span><span class="pun">,</span><span class="pln"> num_routes</span><span class="pun">,</span><span class="pln"> routing</span><span class="pun">)</span></pre>

<p>The result is an array whose rows correspond to the routes.</p>
<p>Another reason for storing a solution in an array is that you can save the array to a file,
and later restore the solution from the saved file.</p>
<p>Here's a program that uses the function shown above.</p>
<pre class="prettyprint lang-python"><div class="devsite-code-button-wrapper"><div class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="深色代码主题" aria-label="深色代码主题" data-title="深色代码主题"></div><div class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="点击复制" aria-label="点击复制" data-title="点击复制"></div></div><span class="str">"""Vehicle Routing Problem"""</span><span class="pln"><br></span><span class="kwd">from</span><span class="pln"> __future__ </span><span class="kwd">import</span><span class="pln"> print_function<br></span><span class="kwd">from</span><span class="pln"> ortools</span><span class="pun">.</span><span class="pln">constraint_solver </span><span class="kwd">import</span><span class="pln"> pywrapcp<br></span><span class="kwd">from</span><span class="pln"> ortools</span><span class="pun">.</span><span class="pln">constraint_solver </span><span class="kwd">import</span><span class="pln"> routing_enums_pb2<br><br></span><span class="com">###########################</span><span class="pln"><br></span><span class="com"># Problem Data Definition #</span><span class="pln"><br></span><span class="com">###########################</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> create_data</span><span class="pun">():</span><span class="pln"><br>&nbsp; </span><span class="str">"""Stores the data for the problem"""</span><span class="pln"><br>&nbsp; </span><span class="com"># Locations</span><span class="pln"><br>&nbsp; num_vehicles </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln"><br>&nbsp; depot </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; locations </span><span class="pun">=</span><span class="pln"> </span><span class="pun">\</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">[(</span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pun">),</span><span class="pln"> </span><span class="com"># depot</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln"> </span><span class="com"># row 0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">)]</span><span class="pln"><br>&nbsp; num_locations </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">locations</span><span class="pun">)</span><span class="pln"><br>&nbsp; dist_matrix </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">for</span><span class="pln"> from_node </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">num_locations</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; dist_matrix</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> to_node </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">num_locations</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; dist_matrix</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">][</span><span class="pln">to_node</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; manhattan_distance</span><span class="pun">(</span><span class="pln">locations</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">],</span><span class="pln"> locations</span><span class="pun">[</span><span class="pln">to_node</span><span class="pun">]))</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="pln">num_vehicles</span><span class="pun">,</span><span class="pln"> depot</span><span class="pun">,</span><span class="pln"> locations</span><span class="pun">,</span><span class="pln"> dist_matrix</span><span class="pun">]</span><span class="pln"><br><br></span><span class="com">###################################</span><span class="pln"><br></span><span class="com"># Distance callback and dimension #</span><span class="pln"><br></span><span class="com">####################################</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> manhattan_distance</span><span class="pun">(</span><span class="pln">position_1</span><span class="pun">,</span><span class="pln"> position_2</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="str">"""Computes the Manhattan distance between two points"""</span><span class="pln"><br>&nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="pln">abs</span><span class="pun">(</span><span class="pln">position_1</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> position_2</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])</span><span class="pln"> </span><span class="pun">+</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; abs</span><span class="pun">(</span><span class="pln">position_1</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> position_2</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]))</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> </span><span class="typ">CreateDistanceCallback</span><span class="pun">(</span><span class="pln">dist_matrix</span><span class="pun">):</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">def</span><span class="pln"> dist_callback</span><span class="pun">(</span><span class="pln">from_node</span><span class="pun">,</span><span class="pln"> to_node</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> dist_matrix</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">][</span><span class="pln">to_node</span><span class="pun">]</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">return</span><span class="pln"> dist_callback<br><br><br></span><span class="kwd">def</span><span class="pln"> add_distance_dimension</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">,</span><span class="pln"> dist_callback</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="str">"""Add Global Span constraint"""</span><span class="pln"><br>&nbsp; distance </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Distance"</span><span class="pln"><br>&nbsp; maximum_distance </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3000</span><span class="pln"><br>&nbsp; routing</span><span class="pun">.</span><span class="typ">AddDimension</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; dist_callback</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="com"># null slack</span><span class="pln"><br>&nbsp; &nbsp; maximum_distance</span><span class="pun">,</span><span class="pln"> </span><span class="com"># maximum distance per vehicle</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">True</span><span class="pun">,</span><span class="pln"> </span><span class="com"># start cumul to zero</span><span class="pln"><br>&nbsp; &nbsp; distance</span><span class="pun">)</span><span class="pln"><br>&nbsp; distance_dimension </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">GetDimensionOrDie</span><span class="pun">(</span><span class="pln">distance</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="com"># Try to minimize the max distance among vehicles.</span><span class="pln"><br>&nbsp; distance_dimension</span><span class="pun">.</span><span class="typ">SetGlobalSpanCostCoefficient</span><span class="pun">(</span><span class="lit">100</span><span class="pun">)</span><span class="pln"><br><br></span><span class="com">####################</span><span class="pln"><br></span><span class="com"># Get Routes Array #</span><span class="pln"><br></span><span class="com">####################</span><span class="pln"><br></span><span class="kwd">def</span><span class="pln"> get_routes_array</span><span class="pun">(</span><span class="pln">assignment</span><span class="pun">,</span><span class="pln"> num_vehicles</span><span class="pun">,</span><span class="pln"> routing</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="com"># Get the routes for an assignent and return as a list of lists.</span><span class="pln"><br>&nbsp; routes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln"><br>&nbsp; </span><span class="kwd">for</span><span class="pln"> route_nbr </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">num_vehicles</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; node </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">Start</span><span class="pun">(</span><span class="pln">route_nbr</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; route </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">while</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IsEnd</span><span class="pun">(</span><span class="pln">node</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; index </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">NodeToIndex</span><span class="pun">(</span><span class="pln">node</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; route</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; node </span><span class="pun">=</span><span class="pln"> assignment</span><span class="pun">.</span><span class="typ">Value</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">.</span><span class="typ">NextVar</span><span class="pun">(</span><span class="pln">node</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; routes</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">route</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="kwd">return</span><span class="pln"> routes<br><br></span><span class="com">########</span><span class="pln"><br></span><span class="com"># Main #</span><span class="pln"><br></span><span class="com">########</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> main</span><span class="pun">():</span><span class="pln"><br>&nbsp; </span><span class="str">"""Entry point of the program"""</span><span class="pln"><br>&nbsp; </span><span class="com"># Instantiate the data problem.</span><span class="pln"><br>&nbsp; </span><span class="pun">[</span><span class="pln">num_vehicles</span><span class="pun">,</span><span class="pln"> depot</span><span class="pun">,</span><span class="pln"> locations</span><span class="pun">,</span><span class="pln"> dist_matrix</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> create_data</span><span class="pun">()</span><span class="pln"><br>&nbsp; num_locations </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">locations</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="com"># Create Routing Model</span><span class="pln"><br>&nbsp; routing </span><span class="pun">=</span><span class="pln"> pywrapcp</span><span class="pun">.</span><span class="typ">RoutingModel</span><span class="pun">(</span><span class="pln">num_locations</span><span class="pun">,</span><span class="pln"> num_vehicles</span><span class="pun">,</span><span class="pln"> depot</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="com"># Define weight of each edge</span><span class="pln"><br>&nbsp; dist_callback </span><span class="pun">=</span><span class="pln"> </span><span class="typ">CreateDistanceCallback</span><span class="pun">(</span><span class="pln">dist_matrix</span><span class="pun">)</span><span class="pln"><br>&nbsp; routing</span><span class="pun">.</span><span class="typ">SetArcCostEvaluatorOfAllVehicles</span><span class="pun">(</span><span class="pln">dist_callback</span><span class="pun">)</span><span class="pln"><br>&nbsp; add_distance_dimension</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">,</span><span class="pln"> dist_callback</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="com"># Setting first solution heuristic (cheapest addition).</span><span class="pln"><br>&nbsp; search_parameters </span><span class="pun">=</span><span class="pln"> pywrapcp</span><span class="pun">.</span><span class="typ">RoutingModel</span><span class="pun">.</span><span class="typ">DefaultSearchParameters</span><span class="pun">()</span><span class="pln"><br>&nbsp; search_parameters</span><span class="pun">.</span><span class="pln">first_solution_strategy </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; routing_enums_pb2</span><span class="pun">.</span><span class="typ">FirstSolutionStrategy</span><span class="pun">.</span><span class="pln">PATH_CHEAPEST_ARC</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="com"># Solve the problem.</span><span class="pln"><br>&nbsp; assignment </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">SolveWithParameters</span><span class="pun">(</span><span class="pln">search_parameters</span><span class="pun">)</span><span class="pln"><br>&nbsp; routes </span><span class="pun">=</span><span class="pln"> get_routes_array</span><span class="pun">(</span><span class="pln">assignment</span><span class="pun">,</span><span class="pln"> num_vehicles</span><span class="pun">,</span><span class="pln"> routing</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"Routes array:"</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">routes</span><span class="pun">)</span><span class="pln"><br><br></span><span class="kwd">if</span><span class="pln"> __name__ </span><span class="pun">==</span><span class="pln"> </span><span class="str">'__main__'</span><span class="pun">:</span><span class="pln"><br>&nbsp; main</span><span class="pun">()</span></pre>

<p>When you run this program,the program prints the routes in the following array:</p>
<pre><div class="devsite-code-button-wrapper"><div class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="深色代码主题" aria-label="深色代码主题" data-title="深色代码主题"></div></div>Routes array:
[[10, 16, 14, 9, 20], [13, 15, 21], [5, 6, 2, 8, 22], [12, 11, 3, 4, 1, 7, 23]]</pre>
<p>Note that the array does not include the start and end locations of the routes (which in this case
consists of just the depot).</p>

<h2 id="setting-initial-routes-for-a-search"><a href="https://developers.google.cn/optimization/routing/routing_tasks#top_of_page" class="devsite-back-to-top-link material-icons" data-tooltip-align="b,c" data-tooltip="返回页首" aria-label="返回页首" data-title="返回页首"></a>Setting initial routes for a search</h2>
<p>This section shows how to specify a set of initial routes for a VRP.
To create the initial routes, do the following steps:</p>
<ol>
  <li>Set up the routing model and declare the solver.</li>
  <li>Define an array containing the initial routes. (In this example, the array is defined
     explicitly in the program, but if you have previously saved a solution to a file,
     you can create the array from the file.)</li>
  <li>Create the initial assignment using the method
<a href="https://developers.google.cn/optimization/reference/constraint_solver/routing/RoutingModel#ReadAssignmentFromRoutes">
<code>ReadAssignmentFromRoutes</code></a>.</li>
</ol>
<p>Here's some Python code that takes a random array of initial routes, and creates
the initial assignment:</p>
<pre class="prettyprint lang-python"><div class="devsite-code-button-wrapper"><div class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="深色代码主题" aria-label="深色代码主题" data-title="深色代码主题"></div><div class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="点击复制" aria-label="点击复制" data-title="点击复制"></div></div><span class="pln">initial_routes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[[</span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">16</span><span class="pun">,</span><span class="pln"> </span><span class="lit">14</span><span class="pun">,</span><span class="pln"> </span><span class="lit">13</span><span class="pun">,</span><span class="pln"> </span><span class="lit">12</span><span class="pun">,</span><span class="pln"> </span><span class="lit">11</span><span class="pun">],</span><span class="pln"> </span><span class="pun">[</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="lit">9</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10</span><span class="pun">],</span><span class="pln"> </span><span class="pun">[</span><span class="lit">15</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> </span><span class="pun">[</span><span class="lit">7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">]]</span><span class="pln"><br>routing </span><span class="pun">=</span><span class="pln"> pywrapcp</span><span class="pun">.</span><span class="typ">RoutingModel</span><span class="pun">(</span><span class="pln">num_locations</span><span class="pun">,</span><span class="pln"> num_vehicles</span><span class="pun">,</span><span class="pln"> depot</span><span class="pun">)</span><span class="pln"><br>dist_callback </span><span class="pun">=</span><span class="pln"> create_dist_callback</span><span class="pun">(</span><span class="pln">dist_matrix</span><span class="pun">)</span><span class="pln"><br>add_distance_dimension</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">,</span><span class="pln"> dist_callback</span><span class="pun">)</span><span class="pln"><br>routing</span><span class="pun">.</span><span class="typ">SetArcCostEvaluatorOfAllVehicles</span><span class="pun">(</span><span class="pln">dist_callback</span><span class="pun">)</span><span class="pln"><br>initial_assignment </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">ReadAssignmentFromRoutes</span><span class="pun">(</span><span class="pln">initial_routes</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">True</span><span class="pun">)</span></pre>

<p>Note that the initial routes do not include the depot.</p>

<p>The following program uses this code to set the initial routes and then performs a search.</p>
<pre class="prettyprint lang-python"><div class="devsite-code-button-wrapper"><div class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="深色代码主题" aria-label="深色代码主题" data-title="深色代码主题"></div><div class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="点击复制" aria-label="点击复制" data-title="点击复制"></div></div><span class="kwd">from</span><span class="pln"> __future__ </span><span class="kwd">import</span><span class="pln"> print_function<br></span><span class="kwd">import</span><span class="pln"> math<br></span><span class="kwd">from</span><span class="pln"> ortools</span><span class="pun">.</span><span class="pln">constraint_solver </span><span class="kwd">import</span><span class="pln"> pywrapcp<br></span><span class="kwd">from</span><span class="pln"> ortools</span><span class="pun">.</span><span class="pln">constraint_solver </span><span class="kwd">import</span><span class="pln"> routing_enums_pb2<br><br></span><span class="com">###########################</span><span class="pln"><br></span><span class="com"># Problem Data Definition #</span><span class="pln"><br></span><span class="com">###########################</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> create_data</span><span class="pun">():</span><span class="pln"><br>&nbsp; </span><span class="str">"""Stores the data for the problem"""</span><span class="pln"><br>&nbsp; </span><span class="com"># Locations</span><span class="pln"><br>&nbsp; num_vehicles </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln"><br>&nbsp; depot </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; locations </span><span class="pun">=</span><span class="pln"> </span><span class="pun">\</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">[(</span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pun">),</span><span class="pln"> </span><span class="com"># depot</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln"> </span><span class="com"># row 0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">)]</span><span class="pln"><br>&nbsp; num_locations </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">locations</span><span class="pun">)</span><span class="pln"><br>&nbsp; dist_matrix </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">for</span><span class="pln"> from_node </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">num_locations</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; dist_matrix</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> to_node </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">num_locations</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; dist_matrix</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">][</span><span class="pln">to_node</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; manhattan_distance</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; locations</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">],</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; locations</span><span class="pun">[</span><span class="pln">to_node</span><span class="pun">]))</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="pln">num_vehicles</span><span class="pun">,</span><span class="pln"> depot</span><span class="pun">,</span><span class="pln"> locations</span><span class="pun">,</span><span class="pln"> dist_matrix</span><span class="pun">]</span><span class="pln"><br><br></span><span class="com">###################################</span><span class="pln"><br></span><span class="com"># Distance callback and dimension #</span><span class="pln"><br></span><span class="com">###################################</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> manhattan_distance</span><span class="pun">(</span><span class="pln">position_1</span><span class="pun">,</span><span class="pln"> position_2</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="str">"""Computes the Manhattan distance between two points"""</span><span class="pln"><br>&nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="pln">abs</span><span class="pun">(</span><span class="pln">position_1</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> position_2</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])</span><span class="pln"> </span><span class="pun">+</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; abs</span><span class="pun">(</span><span class="pln">position_1</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> position_2</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]))</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> create_dist_callback</span><span class="pun">(</span><span class="pln">dist_matrix</span><span class="pun">):</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">def</span><span class="pln"> dist_callback</span><span class="pun">(</span><span class="pln">from_node</span><span class="pun">,</span><span class="pln"> to_node</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> dist_matrix</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">][</span><span class="pln">to_node</span><span class="pun">]</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">return</span><span class="pln"> dist_callback<br><br></span><span class="kwd">def</span><span class="pln"> add_distance_dimension</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">,</span><span class="pln"> dist_callback</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="str">"""Add Global Span constraint"""</span><span class="pln"><br>&nbsp; distance </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Distance"</span><span class="pln"><br>&nbsp; maximum_distance </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3000</span><span class="pln"><br>&nbsp; routing</span><span class="pun">.</span><span class="typ">AddDimension</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; dist_callback</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="com"># null slack</span><span class="pln"><br>&nbsp; &nbsp; maximum_distance</span><span class="pun">,</span><span class="pln"> </span><span class="com"># maximum distance per vehicle</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">True</span><span class="pun">,</span><span class="pln"> </span><span class="com"># start cumul to zero</span><span class="pln"><br>&nbsp; &nbsp; distance</span><span class="pun">)</span><span class="pln"><br>&nbsp; distance_dimension </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">GetDimensionOrDie</span><span class="pun">(</span><span class="pln">distance</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="com"># Try to minimize the max distance among vehicles.</span><span class="pln"><br>&nbsp; distance_dimension</span><span class="pun">.</span><span class="typ">SetGlobalSpanCostCoefficient</span><span class="pun">(</span><span class="lit">100</span><span class="pun">)</span><span class="pln"><br><br></span><span class="com">################</span><span class="pln"><br></span><span class="com"># Print Routes #</span><span class="pln"><br></span><span class="com">################</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> print_routes</span><span class="pun">(</span><span class="pln">num_vehicles</span><span class="pun">,</span><span class="pln"> locations</span><span class="pun">,</span><span class="pln"> routing</span><span class="pun">,</span><span class="pln"> assignment</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="str">"""Prints assignment on console"""</span><span class="pln"><br>&nbsp; total_dist </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">for</span><span class="pln"> vehicle_id </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">num_vehicles</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; index </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">Start</span><span class="pun">(</span><span class="pln">vehicle_id</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; plan_output </span><span class="pun">=</span><span class="pln"> </span><span class="str">'Route for vehicle {0}:\n'</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">vehicle_id</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; route_dist </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">while</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IsEnd</span><span class="pun">(</span><span class="pln">index</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; node </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IndexToNode</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; next_node </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IndexToNode</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; assignment</span><span class="pun">.</span><span class="typ">Value</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">.</span><span class="typ">NextVar</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; route_dist </span><span class="pun">+=</span><span class="pln"> manhattan_distance</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; locations</span><span class="pun">[</span><span class="pln">node</span><span class="pun">],</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; locations</span><span class="pun">[</span><span class="pln">next_node</span><span class="pun">])</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; plan_output </span><span class="pun">+=</span><span class="pln"> </span><span class="str">' {node} -&gt; '</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; node</span><span class="pun">=</span><span class="pln">node</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; index </span><span class="pun">=</span><span class="pln"> assignment</span><span class="pun">.</span><span class="typ">Value</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">.</span><span class="typ">NextVar</span><span class="pun">(</span><span class="pln">index</span><span class="pun">))</span><span class="pln"><br><br>&nbsp; &nbsp; node </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IndexToNode</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; total_dist </span><span class="pun">+=</span><span class="pln"> route_dist<br>&nbsp; &nbsp; plan_output </span><span class="pun">+=</span><span class="pln"> </span><span class="str">' {node}\n'</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; node</span><span class="pun">=</span><span class="pln">node</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; plan_output </span><span class="pun">+=</span><span class="pln"> </span><span class="str">'Distance of route {0}: {dist}\n'</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; vehicle_id</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; dist</span><span class="pun">=</span><span class="pln">route_dist</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">plan_output</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'Total distance of all routes: {dist}'</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">dist</span><span class="pun">=</span><span class="pln">total_dist</span><span class="pun">))</span><span class="pln"><br><br></span><span class="com">########</span><span class="pln"><br></span><span class="com"># Main #</span><span class="pln"><br></span><span class="com">########</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> main</span><span class="pun">():</span><span class="pln"><br>&nbsp; </span><span class="com"># Create the data.</span><span class="pln"><br>&nbsp; </span><span class="pun">[</span><span class="pln">num_vehicles</span><span class="pun">,</span><span class="pln"> depot</span><span class="pun">,</span><span class="pln"> locations</span><span class="pun">,</span><span class="pln"> dist_matrix</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> create_data</span><span class="pun">()</span><span class="pln"><br>&nbsp; num_locations </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">locations</span><span class="pun">)</span><span class="pln"><br><br>&nbsp; </span><span class="com"># Create routing model.</span><span class="pln"><br>&nbsp; </span><span class="kwd">if</span><span class="pln"> num_locations </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com"># Set initial routes.</span><span class="pln"><br>&nbsp; &nbsp; initial_routes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[[</span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">16</span><span class="pun">,</span><span class="pln"> </span><span class="lit">14</span><span class="pun">,</span><span class="pln"> </span><span class="lit">13</span><span class="pun">,</span><span class="pln"> </span><span class="lit">12</span><span class="pun">,</span><span class="pln"> </span><span class="lit">11</span><span class="pun">],</span><span class="pln"> </span><span class="pun">[</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="lit">9</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10</span><span class="pun">],</span><span class="pln"> </span><span class="pun">[</span><span class="lit">15</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> </span><span class="pun">[</span><span class="lit">7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">]]</span><span class="pln"><br>&nbsp; &nbsp; routing </span><span class="pun">=</span><span class="pln"> pywrapcp</span><span class="pun">.</span><span class="typ">RoutingModel</span><span class="pun">(</span><span class="pln">num_locations</span><span class="pun">,</span><span class="pln"> num_vehicles</span><span class="pun">,</span><span class="pln"> depot</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; dist_callback </span><span class="pun">=</span><span class="pln"> create_dist_callback</span><span class="pun">(</span><span class="pln">dist_matrix</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; routing</span><span class="pun">.</span><span class="typ">SetArcCostEvaluatorOfAllVehicles</span><span class="pun">(</span><span class="pln">dist_callback</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; add_distance_dimension</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">,</span><span class="pln"> dist_callback</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; initial_assignment </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">ReadAssignmentFromRoutes</span><span class="pun">(</span><span class="pln">initial_routes</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">True</span><span class="pun">)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"Initial assignment:\n"</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; print_routes</span><span class="pun">(</span><span class="pln">num_vehicles</span><span class="pun">,</span><span class="pln"> locations</span><span class="pun">,</span><span class="pln"> routing</span><span class="pun">,</span><span class="pln"> initial_assignment</span><span class="pun">)</span><span class="pln"><br><br>&nbsp; &nbsp; search_parameters </span><span class="pun">=</span><span class="pln"> pywrapcp</span><span class="pun">.</span><span class="typ">RoutingModel</span><span class="pun">.</span><span class="typ">DefaultSearchParameters</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; final_assignment </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">SolveFromAssignmentWithParameters</span><span class="pun">(</span><span class="pln">initial_assignment</span><span class="pun">,</span><span class="pln"> search_parameters</span><span class="pun">)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> final_assignment</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"\nFinal assignment:\n"</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; print_routes</span><span class="pun">(</span><span class="pln">num_vehicles</span><span class="pun">,</span><span class="pln"> locations</span><span class="pun">,</span><span class="pln"> routing</span><span class="pun">,</span><span class="pln"> final_assignment</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">else</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'No solution found.'</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="kwd">else</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'Specify an instance greater than 0.'</span><span class="pun">)</span><span class="pln"><br><br><br></span><span class="kwd">if</span><span class="pln"> __name__ </span><span class="pun">==</span><span class="pln"> </span><span class="str">'__main__'</span><span class="pun">:</span><span class="pln"><br>&nbsp; main</span><span class="pun">()</span></pre>

<p>When you run the program, it returns the following output:</p>
<pre><div class="devsite-code-button-wrapper"><div class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="深色代码主题" aria-label="深色代码主题" data-title="深色代码主题"></div></div>Initial assignment:

Route for vehicle 0:
 0 -&gt;  8 -&gt;  16 -&gt;  14 -&gt;  13 -&gt;  12 -&gt;  11 -&gt;  0
Distance of route 0: 22

Route for vehicle 1:
 0 -&gt;  3 -&gt;  4 -&gt;  9 -&gt;  10 -&gt;  0
Distance of route 1: 24

Route for vehicle 2:
 0 -&gt;  15 -&gt;  1 -&gt;  0
Distance of route 2: 24

Route for vehicle 3:
 0 -&gt;  7 -&gt;  5 -&gt;  2 -&gt;  6 -&gt;  0
Distance of route 3: 18

Total distance of all routes: 88

Final assignment:

Route for vehicle 0:
 0 -&gt;  9 -&gt;  10 -&gt;  16 -&gt;  14 -&gt;  0
Distance of route 0: 16

Route for vehicle 1:
 0 -&gt;  12 -&gt;  11 -&gt;  15 -&gt;  13 -&gt;  0
Distance of route 1: 16

Route for vehicle 2:
 0 -&gt;  3 -&gt;  4 -&gt;  1 -&gt;  7 -&gt;  0
Distance of route 2: 16

Route for vehicle 3:
 0 -&gt;  5 -&gt;  2 -&gt;  6 -&gt;  8 -&gt;  0
Distance of route 3: 16

Total distance of all routes: 64</pre>

<p>Not surprisingly, the final routes have shorter total distance than the initial routes.</p>

<h2 id="setting-start-and-end-locations-for-routes"><a href="https://developers.google.cn/optimization/routing/routing_tasks#top_of_page" class="devsite-back-to-top-link material-icons" data-tooltip-align="b,c" data-tooltip="返回页首" aria-label="返回页首" data-title="返回页首"></a>Setting start and end locations for routes</h2>
<p>So far, we have assumed that all vehicles start and end at a single location, the depot.
You can also set possibly different start and end locations for each vehicle in the problem.
To do so, pass two vectors,
containing the indices of the start and end locations, as inputs to the
<a href="https://developers.google.cn/optimization/reference/constraint_solver/routing/RoutingModel">RoutingModel</a> method in
the main function. Here's some example code to do this in a problem with four vehicles:</p>
<pre class="prettyprint lang-python"><div class="devsite-code-button-wrapper"><div class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="深色代码主题" aria-label="深色代码主题" data-title="深色代码主题"></div><div class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="点击复制" aria-label="点击复制" data-title="点击复制"></div></div><span class="pln">start_locations </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">15</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">]</span><span class="pln"><br>end_locations </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">11</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">]</span><span class="pln"><br>routing </span><span class="pun">=</span><span class="pln"> pywrapcp</span><span class="pun">.</span><span class="typ">RoutingModel</span><span class="pun">(</span><span class="pln">num_locations</span><span class="pun">,</span><span class="pln"> num_vehicles</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; start_locations</span><span class="pun">,</span><span class="pln"> end_locations</span><span class="pun">)</span></pre>
<p>Here's a complete program that sets the start and end locations this way.</p>
<pre class="prettyprint lang-python"><div class="devsite-code-button-wrapper"><div class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="深色代码主题" aria-label="深色代码主题" data-title="深色代码主题"></div><div class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="点击复制" aria-label="点击复制" data-title="点击复制"></div></div><span class="str">"""Vehicle Routing Problem"""</span><span class="pln"><br></span><span class="kwd">from</span><span class="pln"> __future__ </span><span class="kwd">import</span><span class="pln"> print_function<br></span><span class="kwd">from</span><span class="pln"> ortools</span><span class="pun">.</span><span class="pln">constraint_solver </span><span class="kwd">import</span><span class="pln"> pywrapcp<br></span><span class="kwd">from</span><span class="pln"> ortools</span><span class="pun">.</span><span class="pln">constraint_solver </span><span class="kwd">import</span><span class="pln"> routing_enums_pb2<br><br></span><span class="com">###########################</span><span class="pln"><br></span><span class="com"># Problem Data Definition #</span><span class="pln"><br></span><span class="com">###########################</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> create_data</span><span class="pun">():</span><span class="pln"><br>&nbsp; </span><span class="str">"""Stores the data for the problem"""</span><span class="pln"><br>&nbsp; </span><span class="com"># Locations</span><span class="pln"><br>&nbsp; num_vehicles </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln"><br>&nbsp; depot </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; locations </span><span class="pun">=</span><span class="pln"> </span><span class="pun">\</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">[(</span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pun">),</span><span class="pln"> </span><span class="com"># depot</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln"> </span><span class="com"># row 0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">)]</span><span class="pln"><br>&nbsp; num_locations </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">locations</span><span class="pun">)</span><span class="pln"><br>&nbsp; dist_matrix </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">for</span><span class="pln"> from_node </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">num_locations</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; dist_matrix</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> to_node </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">num_locations</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; dist_matrix</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">][</span><span class="pln">to_node</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; manhattan_distance</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; locations</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">],</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; locations</span><span class="pun">[</span><span class="pln">to_node</span><span class="pun">]))</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="pln">num_vehicles</span><span class="pun">,</span><span class="pln"> depot</span><span class="pun">,</span><span class="pln"> locations</span><span class="pun">,</span><span class="pln"> dist_matrix</span><span class="pun">]</span><span class="pln"><br><br></span><span class="com">###################################</span><span class="pln"><br></span><span class="com"># Distance callback and dimension #</span><span class="pln"><br></span><span class="com">###################################</span><span class="pln"><br><br><br></span><span class="kwd">def</span><span class="pln"> manhattan_distance</span><span class="pun">(</span><span class="pln">position_1</span><span class="pun">,</span><span class="pln"> position_2</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="str">"""Computes the Manhattan distance between two points"""</span><span class="pln"><br>&nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="pln">abs</span><span class="pun">(</span><span class="pln">position_1</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> position_2</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])</span><span class="pln"> </span><span class="pun">+</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; abs</span><span class="pun">(</span><span class="pln">position_1</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> position_2</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]))</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> </span><span class="typ">CreateDistanceCallback</span><span class="pun">(</span><span class="pln">dist_matrix</span><span class="pun">):</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">def</span><span class="pln"> dist_callback</span><span class="pun">(</span><span class="pln">from_node</span><span class="pun">,</span><span class="pln"> to_node</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> dist_matrix</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">][</span><span class="pln">to_node</span><span class="pun">]</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">return</span><span class="pln"> dist_callback<br><br><br></span><span class="kwd">def</span><span class="pln"> add_distance_dimension</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">,</span><span class="pln"> dist_callback</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="str">"""Add Global Span constraint"""</span><span class="pln"><br>&nbsp; distance </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Distance"</span><span class="pln"><br>&nbsp; maximum_distance </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3000</span><span class="pln"><br>&nbsp; routing</span><span class="pun">.</span><span class="typ">AddDimension</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; dist_callback</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="com"># null slack</span><span class="pln"><br>&nbsp; &nbsp; maximum_distance</span><span class="pun">,</span><span class="pln"> </span><span class="com"># maximum distance per vehicle</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">True</span><span class="pun">,</span><span class="pln"> </span><span class="com"># start cumul to zero</span><span class="pln"><br>&nbsp; &nbsp; distance</span><span class="pun">)</span><span class="pln"><br>&nbsp; distance_dimension </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">GetDimensionOrDie</span><span class="pun">(</span><span class="pln">distance</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="com"># Try to minimize the max distance among vehicles.</span><span class="pln"><br>&nbsp; distance_dimension</span><span class="pun">.</span><span class="typ">SetGlobalSpanCostCoefficient</span><span class="pun">(</span><span class="lit">100</span><span class="pun">)</span><span class="pln"><br><br></span><span class="com">################</span><span class="pln"><br></span><span class="com"># Print Routes #</span><span class="pln"><br></span><span class="com">################</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> print_routes</span><span class="pun">(</span><span class="pln">num_vehicles</span><span class="pun">,</span><span class="pln"> locations</span><span class="pun">,</span><span class="pln"> routing</span><span class="pun">,</span><span class="pln"> assignment</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="str">"""Prints assignment on console"""</span><span class="pln"><br>&nbsp; total_dist </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">for</span><span class="pln"> vehicle_id </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">num_vehicles</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; index </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">Start</span><span class="pun">(</span><span class="pln">vehicle_id</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; plan_output </span><span class="pun">=</span><span class="pln"> </span><span class="str">'Route for vehicle {0}:\n'</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">vehicle_id</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; route_dist </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">while</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IsEnd</span><span class="pun">(</span><span class="pln">index</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; node </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IndexToNode</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; next_node </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IndexToNode</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; assignment</span><span class="pun">.</span><span class="typ">Value</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">.</span><span class="typ">NextVar</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; route_dist </span><span class="pun">+=</span><span class="pln"> manhattan_distance</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; locations</span><span class="pun">[</span><span class="pln">node</span><span class="pun">],</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; locations</span><span class="pun">[</span><span class="pln">next_node</span><span class="pun">])</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; plan_output </span><span class="pun">+=</span><span class="pln"> </span><span class="str">' {node} -&gt; '</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; node</span><span class="pun">=</span><span class="pln">node</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; index </span><span class="pun">=</span><span class="pln"> assignment</span><span class="pun">.</span><span class="typ">Value</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">.</span><span class="typ">NextVar</span><span class="pun">(</span><span class="pln">index</span><span class="pun">))</span><span class="pln"><br><br>&nbsp; &nbsp; node </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IndexToNode</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; total_dist </span><span class="pun">+=</span><span class="pln"> route_dist<br>&nbsp; &nbsp; plan_output </span><span class="pun">+=</span><span class="pln"> </span><span class="str">' {node}\n'</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; node</span><span class="pun">=</span><span class="pln">node</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; plan_output </span><span class="pun">+=</span><span class="pln"> </span><span class="str">'Distance of route {0}: {dist}\n'</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; vehicle_id</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; dist</span><span class="pun">=</span><span class="pln">route_dist</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">plan_output</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'Total distance of all routes: {dist}'</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">dist</span><span class="pun">=</span><span class="pln">total_dist</span><span class="pun">))</span><span class="pln"><br><br></span><span class="com">########</span><span class="pln"><br></span><span class="com"># Main #</span><span class="pln"><br></span><span class="com">########</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> main</span><span class="pun">():</span><span class="pln"><br>&nbsp; </span><span class="str">"""Entry point of the program"""</span><span class="pln"><br>&nbsp; </span><span class="com"># Create data.</span><span class="pln"><br>&nbsp; </span><span class="pun">[</span><span class="pln">num_vehicles</span><span class="pun">,</span><span class="pln"> depot</span><span class="pun">,</span><span class="pln"> locations</span><span class="pun">,</span><span class="pln"> dist_matrix</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> create_data</span><span class="pun">()</span><span class="pln"><br>&nbsp; num_locations </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">locations</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="com"># Create Routing Model</span><span class="pln"><br>&nbsp; start_locations </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">15</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">]</span><span class="pln"><br>&nbsp; end_locations </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">11</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">]</span><span class="pln"><br>&nbsp; routing </span><span class="pun">=</span><span class="pln"> pywrapcp</span><span class="pun">.</span><span class="typ">RoutingModel</span><span class="pun">(</span><span class="pln">num_locations</span><span class="pun">,</span><span class="pln"> num_vehicles</span><span class="pun">,</span><span class="pln"> start_locations</span><span class="pun">,</span><span class="pln"> end_locations</span><span class="pun">)</span><span class="pln"><br><br>&nbsp; dist_callback </span><span class="pun">=</span><span class="pln"> </span><span class="typ">CreateDistanceCallback</span><span class="pun">(</span><span class="pln">dist_matrix</span><span class="pun">)</span><span class="pln"><br>&nbsp; add_distance_dimension</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">,</span><span class="pln"> dist_callback</span><span class="pun">)</span><span class="pln"><br>&nbsp; routing</span><span class="pun">.</span><span class="typ">SetArcCostEvaluatorOfAllVehicles</span><span class="pun">(</span><span class="pln">dist_callback</span><span class="pun">)</span><span class="pln"><br>&nbsp; search_parameters </span><span class="pun">=</span><span class="pln"> pywrapcp</span><span class="pun">.</span><span class="typ">RoutingModel</span><span class="pun">.</span><span class="typ">DefaultSearchParameters</span><span class="pun">()</span><span class="pln"><br>&nbsp; search_parameters</span><span class="pun">.</span><span class="pln">first_solution_strategy </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; routing_enums_pb2</span><span class="pun">.</span><span class="typ">FirstSolutionStrategy</span><span class="pun">.</span><span class="pln">PATH_CHEAPEST_ARC</span><span class="pun">)</span><span class="pln"><br><br>&nbsp; </span><span class="com"># Solve the problem.</span><span class="pln"><br>&nbsp; assignment </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">SolveWithParameters</span><span class="pun">(</span><span class="pln">search_parameters</span><span class="pun">)</span><span class="pln"><br>&nbsp; print_routes</span><span class="pun">(</span><span class="pln">num_vehicles</span><span class="pun">,</span><span class="pln"> locations</span><span class="pun">,</span><span class="pln"> routing</span><span class="pun">,</span><span class="pln"> assignment</span><span class="pun">)</span><span class="pln"><br><br></span><span class="kwd">if</span><span class="pln"> __name__ </span><span class="pun">==</span><span class="pln"> </span><span class="str">'__main__'</span><span class="pun">:</span><span class="pln"><br>&nbsp; main</span><span class="pun">()</span><span class="pln"><br></span></pre>
<p>When you run program, you get the following output, in which the routes start and
end at the specificed locations:</p>
<pre><div class="devsite-code-button-wrapper"><div class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="深色代码主题" aria-label="深色代码主题" data-title="深色代码主题"></div></div>Route for vehicle 0:
 8 -&gt;  16 -&gt;  14 -&gt;  13 -&gt;  12 -&gt;  11
Distance of route 0: 14

Route for vehicle 1:
 3 -&gt;  4 -&gt;  0 -&gt;  9 -&gt;  10
Distance of route 1: 12

Route for vehicle 2:
 15 -&gt;  1
Distance of route 2: 10

Route for vehicle 3:
 7 -&gt;  5 -&gt;  2 -&gt;  6
Distance of route 3: 11

Total distance of all routes: 47</pre>

<p>The total distance is shorter than in the previous example because the vehicles are not required
to start or end at the depot.</p>

<h2 id="allowing-arbitrary-start-and-end-locations"><a href="https://developers.google.cn/optimization/routing/routing_tasks#top_of_page" class="devsite-back-to-top-link material-icons" data-tooltip-align="b,c" data-tooltip="返回页首" aria-label="返回页首" data-title="返回页首"></a>Allowing arbitrary start and end locations</h2>
<p>In other versions of the vehicle routing problem, vehicles are allowed to start and end
at arbitrary locations. To set up the problem this way,
simply modify the distance callback so that distance from the depot to any other location
is 0. This turns the depot into  a dummy location, whose position has no effect on the
optimal routes.</p>
<p>Here's how to modify the distance matrix to make the distance from the depot to all other nodes 0.
</p><pre class="prettyprint lang-python"><div class="devsite-code-button-wrapper"><div class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="深色代码主题" aria-label="深色代码主题" data-title="深色代码主题"></div><div class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="点击复制" aria-label="点击复制" data-title="点击复制"></div></div><span class="pln">&nbsp; locations </span><span class="pun">=</span><span class="pln"> </span><span class="pun">\</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">[(</span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pun">),</span><span class="pln"> </span><span class="com"># depot</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln"> </span><span class="com"># row 0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">)]</span><span class="pln"><br>&nbsp; num_locations </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">locations</span><span class="pun">)</span><span class="pln"><br>&nbsp; dist_matrix </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">for</span><span class="pln"> from_node </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">num_locations</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; dist_matrix</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> to_node </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">num_locations</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> from_node </span><span class="pun">==</span><span class="pln"> depot </span><span class="kwd">or</span><span class="pln"> to_node </span><span class="pun">==</span><span class="pln"> depot</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com"># Define the distance from the depot to any node to be 0.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">matrix</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">][</span><span class="pln">to_node</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">else</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dist_matrix</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">][</span><span class="pln">to_node</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; manhattan_distance</span><span class="pun">(</span><span class="pln">locations</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">],</span><span class="pln"> locations</span><span class="pun">[</span><span class="pln">to_node</span><span class="pun">]))</span></pre>
Note that <code>dist_matrix[from_node]{to_node]</code> is 0 when either <code>from_node</code> or
<code>to_node</code> is the depot.<p></p>
<p>Here's a complete program that uses this modified distance matrix:</p>
<pre class="prettyprint lang-python"><div class="devsite-code-button-wrapper"><div class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="深色代码主题" aria-label="深色代码主题" data-title="深色代码主题"></div><div class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="点击复制" aria-label="点击复制" data-title="点击复制"></div></div><span class="str">"""Vehicle Routing Problem"""</span><span class="pln"><br></span><span class="kwd">from</span><span class="pln"> __future__ </span><span class="kwd">import</span><span class="pln"> print_function<br></span><span class="kwd">from</span><span class="pln"> ortools</span><span class="pun">.</span><span class="pln">constraint_solver </span><span class="kwd">import</span><span class="pln"> pywrapcp<br></span><span class="kwd">from</span><span class="pln"> ortools</span><span class="pun">.</span><span class="pln">constraint_solver </span><span class="kwd">import</span><span class="pln"> routing_enums_pb2<br><br></span><span class="com">###########################</span><span class="pln"><br></span><span class="com"># Problem Data Definition #</span><span class="pln"><br></span><span class="com">###########################</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> create_data</span><span class="pun">():</span><span class="pln"><br>&nbsp; </span><span class="str">"""Stores the data for the problem"""</span><span class="pln"><br>&nbsp; </span><span class="com"># Locations</span><span class="pln"><br>&nbsp; num_vehicles </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln"><br>&nbsp; depot </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; locations </span><span class="pun">=</span><span class="pln"> </span><span class="pun">\</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">[(</span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pun">),</span><span class="pln"> </span><span class="com"># depot</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln"> </span><span class="com"># row 0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">)]</span><span class="pln"><br>&nbsp; num_locations </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">locations</span><span class="pun">)</span><span class="pln"><br>&nbsp; dist_matrix </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">for</span><span class="pln"> from_node </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">num_locations</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; dist_matrix</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> to_node </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">num_locations</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> from_node </span><span class="pun">==</span><span class="pln"> depot </span><span class="kwd">or</span><span class="pln"> to_node </span><span class="pun">==</span><span class="pln"> depot</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com"># Define the distance from the depot to any node to be 0.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">matrix</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">][</span><span class="pln">to_node</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">else</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dist_matrix</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">][</span><span class="pln">to_node</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; manhattan_distance</span><span class="pun">(</span><span class="pln">locations</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">],</span><span class="pln"> locations</span><span class="pun">[</span><span class="pln">to_node</span><span class="pun">]))</span><span class="pln"><br>&nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="pln">num_vehicles</span><span class="pun">,</span><span class="pln"> depot</span><span class="pun">,</span><span class="pln"> locations</span><span class="pun">,</span><span class="pln"> dist_matrix</span><span class="pun">]</span><span class="pln"><br><br></span><span class="com">###################################</span><span class="pln"><br></span><span class="com"># Distance callback and dimension #</span><span class="pln"><br></span><span class="com">###################################</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> manhattan_distance</span><span class="pun">(</span><span class="pln">position_1</span><span class="pun">,</span><span class="pln"> position_2</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="str">"""Computes the Manhattan distance between two points"""</span><span class="pln"><br>&nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="pln">abs</span><span class="pun">(</span><span class="pln">position_1</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> position_2</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])</span><span class="pln"> </span><span class="pun">+</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; abs</span><span class="pun">(</span><span class="pln">position_1</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> position_2</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]))</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> </span><span class="typ">CreateDistanceCallback</span><span class="pun">(</span><span class="pln">dist_matrix</span><span class="pun">):</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">def</span><span class="pln"> dist_callback</span><span class="pun">(</span><span class="pln">from_node</span><span class="pun">,</span><span class="pln"> to_node</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> dist_matrix</span><span class="pun">[</span><span class="pln">from_node</span><span class="pun">][</span><span class="pln">to_node</span><span class="pun">]</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">return</span><span class="pln"> dist_callback<br><br></span><span class="kwd">def</span><span class="pln"> add_distance_dimension</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">,</span><span class="pln"> dist_callback</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="str">"""Add Global Span constraint"""</span><span class="pln"><br>&nbsp; distance </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Distance"</span><span class="pln"><br>&nbsp; maximum_distance </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3000</span><span class="pln"><br>&nbsp; routing</span><span class="pun">.</span><span class="typ">AddDimension</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; dist_callback</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="com"># null slack</span><span class="pln"><br>&nbsp; &nbsp; maximum_distance</span><span class="pun">,</span><span class="pln"> </span><span class="com"># maximum distance per vehicle</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">True</span><span class="pun">,</span><span class="pln"> </span><span class="com"># start cumul to zero</span><span class="pln"><br>&nbsp; &nbsp; distance</span><span class="pun">)</span><span class="pln"><br>&nbsp; distance_dimension </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">GetDimensionOrDie</span><span class="pun">(</span><span class="pln">distance</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="com"># Try to minimize the max distance among vehicles.</span><span class="pln"><br>&nbsp; distance_dimension</span><span class="pun">.</span><span class="typ">SetGlobalSpanCostCoefficient</span><span class="pun">(</span><span class="lit">100</span><span class="pun">)</span><span class="pln"><br><br></span><span class="com">################</span><span class="pln"><br></span><span class="com"># Print Routes #</span><span class="pln"><br></span><span class="com">################</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> print_routes</span><span class="pun">(</span><span class="pln">num_vehicles</span><span class="pun">,</span><span class="pln"> locations</span><span class="pun">,</span><span class="pln"> routing</span><span class="pun">,</span><span class="pln"> assignment</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="str">"""Prints assignment on console"""</span><span class="pln"><br>&nbsp; total_dist </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">for</span><span class="pln"> vehicle_id </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">num_vehicles</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; index </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">Start</span><span class="pun">(</span><span class="pln">vehicle_id</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com"># Skip depot - vehicles starting at arbitray locations.</span><span class="pln"><br>&nbsp; &nbsp; node </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IndexToNode</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; next_node </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IndexToNode</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; assignment</span><span class="pun">.</span><span class="typ">Value</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">.</span><span class="typ">NextVar</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)))</span><span class="pln"><br>&nbsp; &nbsp; index </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">NodeToIndex</span><span class="pun">(</span><span class="pln">next_node</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; node </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IndexToNode</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; next_node </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IndexToNode</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; assignment</span><span class="pun">.</span><span class="typ">Value</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">.</span><span class="typ">NextVar</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)))</span><span class="pln"><br>&nbsp; &nbsp; plan_output </span><span class="pun">=</span><span class="pln"> </span><span class="str">'Route for vehicle {0}:\n'</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">vehicle_id</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; route_dist </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">while</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IsEnd</span><span class="pun">(</span><span class="pln">index</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; node </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IndexToNode</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; next_node </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IndexToNode</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; assignment</span><span class="pun">.</span><span class="typ">Value</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">.</span><span class="typ">NextVar</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; route_dist </span><span class="pun">+=</span><span class="pln"> manhattan_distance</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; locations</span><span class="pun">[</span><span class="pln">node</span><span class="pun">],</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; locations</span><span class="pun">[</span><span class="pln">next_node</span><span class="pun">])</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; index </span><span class="pun">=</span><span class="pln"> assignment</span><span class="pun">.</span><span class="typ">Value</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">.</span><span class="typ">NextVar</span><span class="pun">(</span><span class="pln">index</span><span class="pun">))</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">IsEnd</span><span class="pun">(</span><span class="pln">index</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; plan_output </span><span class="pun">+=</span><span class="pln"> </span><span class="str">' {node} '</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node</span><span class="pun">=</span><span class="pln">node</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">else</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; plan_output </span><span class="pun">+=</span><span class="pln"> </span><span class="str">' {node} -&gt; '</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node</span><span class="pun">=</span><span class="pln">node</span><span class="pun">)</span><span class="pln"><br><br>&nbsp; &nbsp; total_dist </span><span class="pun">+=</span><span class="pln"> route_dist<br>&nbsp; &nbsp; plan_output </span><span class="pun">+=</span><span class="pln"> </span><span class="str">'\nDistance of route {0}: {dist}\n'</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; vehicle_id</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; dist</span><span class="pun">=</span><span class="pln">route_dist</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">plan_output</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'Total distance of all routes: {dist}'</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">dist</span><span class="pun">=</span><span class="pln">total_dist</span><span class="pun">))</span><span class="pln"><br><br></span><span class="com">########</span><span class="pln"><br></span><span class="com"># Main #</span><span class="pln"><br></span><span class="com">########</span><span class="pln"><br><br></span><span class="kwd">def</span><span class="pln"> main</span><span class="pun">():</span><span class="pln"><br>&nbsp; </span><span class="str">"""Entry point of the program"""</span><span class="pln"><br>&nbsp; </span><span class="com"># Instantiate the data problem.</span><span class="pln"><br>&nbsp; </span><span class="pun">[</span><span class="pln">num_vehicles</span><span class="pun">,</span><span class="pln"> depot</span><span class="pun">,</span><span class="pln"> locations</span><span class="pun">,</span><span class="pln"> dist_matrix</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> create_data</span><span class="pun">()</span><span class="pln"><br>&nbsp; num_locations </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">locations</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="com"># Create Routing Model</span><span class="pln"><br>&nbsp; routing </span><span class="pun">=</span><span class="pln"> pywrapcp</span><span class="pun">.</span><span class="typ">RoutingModel</span><span class="pun">(</span><span class="pln">num_locations</span><span class="pun">,</span><span class="pln"> num_vehicles</span><span class="pun">,</span><span class="pln"> depot</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="com"># Define weight of each edge</span><span class="pln"><br>&nbsp; dist_callback </span><span class="pun">=</span><span class="pln"> </span><span class="typ">CreateDistanceCallback</span><span class="pun">(</span><span class="pln">dist_matrix</span><span class="pun">)</span><span class="pln"><br>&nbsp; routing</span><span class="pun">.</span><span class="typ">SetArcCostEvaluatorOfAllVehicles</span><span class="pun">(</span><span class="pln">dist_callback</span><span class="pun">)</span><span class="pln"><br>&nbsp; add_distance_dimension</span><span class="pun">(</span><span class="pln">routing</span><span class="pun">,</span><span class="pln"> dist_callback</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="com"># Setting first solution heuristic (cheapest addition).</span><span class="pln"><br>&nbsp; search_parameters </span><span class="pun">=</span><span class="pln"> pywrapcp</span><span class="pun">.</span><span class="typ">RoutingModel</span><span class="pun">.</span><span class="typ">DefaultSearchParameters</span><span class="pun">()</span><span class="pln"><br>&nbsp; search_parameters</span><span class="pun">.</span><span class="pln">first_solution_strategy </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; routing_enums_pb2</span><span class="pun">.</span><span class="typ">FirstSolutionStrategy</span><span class="pun">.</span><span class="pln">PATH_CHEAPEST_ARC</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="com"># Solve the problem.</span><span class="pln"><br>&nbsp; assignment </span><span class="pun">=</span><span class="pln"> routing</span><span class="pun">.</span><span class="typ">SolveWithParameters</span><span class="pun">(</span><span class="pln">search_parameters</span><span class="pun">)</span><span class="pln"><br>&nbsp; print_routes</span><span class="pun">(</span><span class="pln">num_vehicles</span><span class="pun">,</span><span class="pln"> locations</span><span class="pun">,</span><span class="pln"> routing</span><span class="pun">,</span><span class="pln"> assignment</span><span class="pun">)</span><span class="pln"><br><br></span><span class="kwd">if</span><span class="pln"> __name__ </span><span class="pun">==</span><span class="pln"> </span><span class="str">'__main__'</span><span class="pun">:</span><span class="pln"><br>&nbsp; main</span><span class="pun">()</span></pre>
<p>Note that the <code>print_routes</code> function has been modified from the earlier examples
so as not to display the depot in the routes.</p>
<p>When you run the program, it returns the following output:</p>
<pre><div class="devsite-code-button-wrapper"><div class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="深色代码主题" aria-label="深色代码主题" data-title="深色代码主题"></div></div>Route for vehicle 0:
 15 -&gt;  11 -&gt;  12 -&gt;  13 -&gt;  14 -&gt;  16
Distance of route 0: 18

Route for vehicle 1:
 3 -&gt;  4 -&gt;  1
Distance of route 1: 9

Route for vehicle 2:
 7 -&gt;  8
Distance of route 2: 6

Route for vehicle 3:
 2 -&gt;  6 -&gt;  5 -&gt;  9 -&gt;  10
Distance of route 3: 16

Total distance of all routes: 49</pre>
  
  </div>
  

  
        
  







        
<div class="devsite-content-footer nocontent">
  
  
    <p>Except as otherwise noted, the content of this page is licensed under the <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 License</a>, and code samples are licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a>. For details, see our <a href="https://developers.google.cn/terms/site-policies">Site Policies</a>. Java is a registered trademark of Oracle and/or its affiliates.</p>
  

  
    
    <p class="devsite-content-footer-date" itemprop="datePublished" content="2018-07-02T13:56:17.511793">
      
      上次更新日期：七月 2, 2018
    </p>
  

</div>

        </article>
      </article>
  

        </div>
      

<footer class="devsite-footer-promos nocontent"><nav class="devsite-full-site-width"><ul class="devsite-footer-promos-list"><li class="devsite-footer-promo"><a href="http://github.com/google/or-tools" class="devsite-footer-promo-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Content Page Footer Promo"><img class="devsite-footer-promo-icon" src="./Common Routing Tasks  _  OR-Tools  _  Google Developers_files/logo-github.svg">
          
          
            GitHub
          
        </a><div class="devsite-footer-promo-description">Download our code</div></li><li class="devsite-footer-promo"><a href="https://groups.google.com/forum/#!forum/or-tools-discuss" class="devsite-footer-promo-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Content Page Footer Promo" data-tooltip-align="b,c" data-tooltip="您所在的区域可能无法访问此链接。" aria-label="您所在的区域可能无法访问此链接。"><img class="devsite-footer-promo-icon" src="./Common Routing Tasks  _  OR-Tools  _  Google Developers_files/groups_24dp.png">
          
          
            Discussion forum
          
        </a><div class="devsite-footer-promo-description">Visit our forum</div></li><li class="devsite-footer-promo"><a href="http://or-tools.blogspot.com/" class="devsite-footer-promo-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Content Page Footer Promo" data-tooltip-align="b,c" data-tooltip="您所在的区域可能无法访问此链接。" aria-label="您所在的区域可能无法访问此链接。"><img class="devsite-footer-promo-icon" src="./Common Routing Tasks  _  OR-Tools  _  Google Developers_files/blogger_24dp.png">
          
          
            Blog
          
        </a><div class="devsite-footer-promo-description">Read our blog</div></li></ul></nav></footer><footer class="devsite-footer-linkboxes nocontent
               devsite-footer-linkboxes-all-backup
               devsite-footer-linkboxes-with-sites"><nav class="devsite-full-site-width"><ul class="devsite-footer-linkboxes-list"><li class="devsite-footer-linkbox devsite-footer-linkbox-backup"><h3 class="devsite-footer-linkbox-heading">社交沟通</h3><ul class="devsite-footer-linkbox-list"><li class="devsite-footer-linkbox-item"><a href="http://developers.googleblog.cn/" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Blog Link">
                博客
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://www.facebook.com/Google-Developers-967415219957038/" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Facebook Link">
                Facebook
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://plus.google.com/+GoogleDevelopers" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer G+ Link" data-tooltip-align="b,c" data-tooltip="您所在的区域可能无法访问此链接。" aria-label="您所在的区域可能无法访问此链接。">
                Google+
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://medium.com/google-developers" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Medium Link">
                Medium
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://twitter.com/googledevs" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Twitter Link">
                Twitter
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://www.youtube.com/channel/UCQqa5UIHtrnpiADC3eHFupw" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer YouTube Link" data-tooltip-align="b,c" data-tooltip="您所在的区域可能无法访问此链接。" aria-label="您所在的区域可能无法访问此链接。">
                YouTube
            </a></li></ul></li><li class="devsite-footer-linkbox devsite-footer-linkbox-backup"><h3 class="devsite-footer-linkbox-heading">计划</h3><ul class="devsite-footer-linkbox-list"><li class="devsite-footer-linkbox-item"><a href="https://www.womentechmakers.com/" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Women Techmakers">
                Women Techmakers
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://developers.google.cn/agency/" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Agency">
                Agency Program
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://developers.google.cn/groups/" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Groups">
                GDG
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://developers.google.cn/experts/" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Experts">
                Google Developers Experts
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://developers.google.cn/startups/" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Startups">
                Startup Launchpad
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://userresearch.google.com/?reserved=0&amp;utm_source=developers.google.com&amp;Q_Language=en&amp;utm_medium=own_srch&amp;utm_campaign=Global-developers&amp;utm_term=0&amp;utm_content=0&amp;productTag=clou&amp;campaignDate=nov18&amp;pType=devel&amp;referral_code=js564523" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer User Studies" data-tooltip-align="b,c" data-tooltip="您所在的区域可能无法访问此链接。" aria-label="您所在的区域可能无法访问此链接。">
                User Studies
            </a></li></ul></li><li class="devsite-footer-linkbox devsite-footer-linkbox-backup"><h3 class="devsite-footer-linkbox-heading">开发者控制台</h3><ul class="devsite-footer-linkbox-list"><li class="devsite-footer-linkbox-item"><a href="https://console.developers.google.com/" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Google Developers Console" data-tooltip-align="b,c" data-tooltip="您所在的区域可能无法访问此链接。" aria-label="您所在的区域可能无法访问此链接。">
                Google API Console
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://console.cloud.google.com/" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Google Cloud Platform Console" data-tooltip-align="b,c" data-tooltip="您所在的区域可能无法访问此链接。" aria-label="您所在的区域可能无法访问此链接。">
                Google Cloud Platform Console
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://play.google.com/apps/publish/" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Google Play Console" data-tooltip-align="b,c" data-tooltip="您所在的区域可能无法访问此链接。" aria-label="您所在的区域可能无法访问此链接。">
                Google Play Console
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://console.firebase.google.com/" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Firebase Console" data-tooltip-align="b,c" data-tooltip="您所在的区域可能无法访问此链接。" aria-label="您所在的区域可能无法访问此链接。">
                Firebase Console
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://console.actions.google.com/" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Actions on Google Console" data-tooltip-align="b,c" data-tooltip="您所在的区域可能无法访问此链接。" aria-label="您所在的区域可能无法访问此链接。">
                Actions on Google Console
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://cast.google.com/publish/" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Cast SDK Developer Console" data-tooltip-align="b,c" data-tooltip="您所在的区域可能无法访问此链接。" aria-label="您所在的区域可能无法访问此链接。">
                Cast SDK Developer Console
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://chrome.google.com/webstore/developer/dashboard" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Chrome Web Store Developer Dashboard" data-tooltip-align="b,c" data-tooltip="您所在的区域可能无法访问此链接。" aria-label="您所在的区域可能无法访问此链接。">
                Chrome Web Store Dashboard
            </a></li></ul></li><li class="devsite-footer-linkbox devsite-footer-linkbox-sites"><a href="https://developers.google.cn/" class="gc-analytics-event devsite-footer-linkbox-logo-link" data-category="Site-Wide Custom Events" data-label="Footer Google Developers Link"><img class="devsite-footer-linkbox-logo" src="./Common Routing Tasks  _  OR-Tools  _  Google Developers_files/lockup-color-knockout.png" alt="Google Developers"></a><ul class="devsite-footer-linkbox-list"><li class="devsite-footer-linkbox-item"><a href="https://developer.android.google.cn/index.html" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Android Link">
                Android
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://developer.chrome.com/home" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Chrome Link" data-tooltip-align="b,c" data-tooltip="您所在的区域可能无法访问此链接。" aria-label="您所在的区域可能无法访问此链接。">
                Chrome
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://firebase.google.cn/" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Firebase Link">
                Firebase
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://cloud.google.com/" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Cloud Link" data-tooltip-align="b,c" data-tooltip="您所在的区域可能无法访问此链接。" aria-label="您所在的区域可能无法访问此链接。">
                Google Cloud Platform
            </a></li><li class="devsite-footer-linkbox-item"><a href="https://developers.google.cn/products/" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Products Link">
                所有产品
            </a></li></ul></li></ul></nav></footer><footer class="devsite-utility-footer"><nav class="devsite-utility-footer-nav devsite-nav devsite-full-site-width"><div class="devsite-utility-footer-nav-left"><form class="devsite-utility-footer-language" action="https://developers.google.cn/i18n/setlang/" method="post"><input type="hidden" name="xsrf_token" value="J0k62jC2iWiHB1chuI9-t3DpWOvVS1U_pCZM7TLQB2o6MTU0NzAxNDIxNDg4NjU4MQ"><input type="hidden" name="next" value="/optimization/routing/routing_tasks"><select class="devsite-utility-footer-language-select kd-select" name="language" track-type="languageSelector" track-name="click" style="display: none;"><option value="id" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="id" track-metadata-original-language="zh-cn" track-metadata-selected-language="id">
            Bahasa Indonesia
          </option><option value="de" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="de" track-metadata-original-language="zh-cn" track-metadata-selected-language="de">
            Deutsch
          </option><option value="en" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="en" track-metadata-original-language="zh-cn" track-metadata-selected-language="en">
            English
          </option><option value="es" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="es" track-metadata-original-language="zh-cn" track-metadata-selected-language="es">
            español
          </option><option value="fr" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="fr" track-metadata-original-language="zh-cn" track-metadata-selected-language="fr">
            français
          </option><option value="pt-br" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="pt-br" track-metadata-original-language="zh-cn" track-metadata-selected-language="pt-br">
            Português Brasileiro
          </option><option value="ru" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="ru" track-metadata-original-language="zh-cn" track-metadata-selected-language="ru">
            Русский
          </option><option value="ja" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="ja" track-metadata-original-language="zh-cn" track-metadata-selected-language="ja">
            日本語
          </option><option value="zh-cn" selected="selected" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="zh-cn" track-metadata-original-language="zh-cn" track-metadata-selected-language="zh-cn">
            简体中文
          </option><option value="ko" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="ko" track-metadata-original-language="zh-cn" track-metadata-selected-language="ko">
            한국어
          </option></select><span class="kd-button kd-menubutton kd-select" track-type="languageSelector" track-name="click"><div class="label">
            简体中文
          </div><div class="kd-disclosureindicator"></div></span></form><span class="devsite-utility-footer-links"><a class="devsite-utility-footer-link gc-analytics-event" href="https://developers.google.cn/terms/site-terms" data-category="Site-Wide Custom Events" data-label="Footer terms link" data-footer-link-id="terms">条款
         </a><a class="devsite-utility-footer-link gc-analytics-event" href="https://policies.google.cn/privacy" data-category="Site-Wide Custom Events" data-label="Footer privacy link" data-footer-link-id="privacy" data-cookie-policy="//policies.google.cn/technologies/cookies">隐私权
         </a></span></div></nav></footer><div class="devsite-feedback-dialog devsite-dialog"><div class="devsite-dialog-contents"><h3>发送以下问题的反馈：</h3><div class="devsite-feedback-item"><a data-type="documentation" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Docs Feedback Image" track-type="feedback" track-name="feedbackDocIcon" track-metadata-position="header"><div class="devsite-feedback-item-icon-container"><div class="devsite-feedback-item-icon-white devsite-feedback-item-icon-docs
                        material-icons"></div></div></a><div class="devsite-feedback-item-name">
          
          此网页
        </div><div class="devsite-feedback-item-description"><a data-type="documentation" tabindex="0" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Docs Feedback Text" track-type="feedback" track-name="feedbackDocText" track-metadata-position="header">
            
            文档反馈
          </a></div></div><div class="devsite-feedback-item"><a data-type="product" tabindex="0" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Product Feedback Image" track-type="feedback" track-name="feedbackProductIcon" track-metadata-position="header"><img src="./Common Routing Tasks  _  OR-Tools  _  Google Developers_files/orLogo.png" class="devsite-feedback-item-icon" alt="OR-Tools"></a><div class="devsite-feedback-item-name">
        OR-Tools
        </div><div class="devsite-feedback-item-description"><a data-type="product" tabindex="0" class="gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Product Feedback Text" track-type="feedback" track-name="feedbackProductText" track-metadata-position="header">
            
            产品反馈
          </a></div></div></div><div class="devsite-dialog-buttons"><button type="button" class="devsite-feedback-cancel button-white gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Cancel Feedback Button" track-type="feedback" track-name="cancelFeedbackButton" track-metadata-position="header">
        
        取消
      </button></div></div><script>
  $(document).ready(function() {
    new devsite.feedback.Widget({
        'product_id': '106275',
        'bucket': '',
        'context': 'DevSite feedback link',
        'version': 'devsite-20190107-r00-rc01.default'
      },
      document.querySelectorAll('.devsite-feedback-button'),
      'zh-cn',
      document.querySelector('.devsite-site-mask'),
      document.querySelector('.devsite-feedback-dialog'),
      document.querySelector('.devsite-feedback-cancel'),
      document.querySelectorAll('.devsite-feedback-item a:not([href])')
    );
  });
  </script></div><script async="" defer="" src="./Common Routing Tasks  _  OR-Tools  _  Google Developers_files/api.js"></script><script src="./Common Routing Tasks  _  OR-Tools  _  Google Developers_files/saved_resource"></script><script src="./Common Routing Tasks  _  OR-Tools  _  Google Developers_files/script_foot_closure__zh_cn.js"></script><script src="./Common Routing Tasks  _  OR-Tools  _  Google Developers_files/script_foot.js"></script><script>
        (function($) {
          
          devsite.devsite.Init($, {'ENABLE_BLOCKED_VIDEO_PLACEHOLDER': 1, 'SITE_NAME': 'devsite_china', 'FULL_SITE_SEARCH_ENABLED': 0, 'ENABLE_CLOUDTRACK': 0, 'VTAGS_ENABLED': 0, 'HISTORY_ENABLED': 0, 'SIDEBAR_MINI_ENABLED': 0, 'VERSION_HASH': '0ee1984e83', 'SCRIPTSAFE_DOMAIN': 'google-developers.gonglchuangl.net', 'ENABLE_BLOCKED_LINK_TOOLTIP': 1, 'ALLOWED_HOSTS': ['.android.com', '.appspot.com', '.gonglchuangl.net', '.google.cn', '.google.com', '.googleplex.com', '.tensorflow.org'], 'BLOCK_RSS_FEEDS': 1},
                               '[]','zh-cn',
                               true, '',
                               {"8e03e230de0bd8a6fe173fdf172e8b3f": true, "8de7a048f21618359bd37f5ce44be073": false, "cb025a64a50094835616312f4774a53d": true, "51470233c56fc1fde50f00b73c52b216": false, "d169d485cf24243a263783dbe42029b1": true, "039e5d84b87fd75807ffb37b7f1bbf2c": true, "700def1a83e356c06c0925afb05de4b0": false, "6749dcb526ce9bde6993550c7d928d24": true, "098dafe57affddc137df300142652cfd": false}, '/optimization/',
                               'https://developers.google.cn/');
        })(jQuery);

        
        devsite.localInit = function() {
          
        };

      </script><script>
      $('.devsite-utility-footer-language-select').each(function() {
        $(this).change(function(){$('.devsite-utility-footer-language').submit();});
      });
      </script></div><span id="devsite-request-elapsed" data-request-elapsed="208.17399025"></span>
<ul class="kd-menulist devsite-hidden" style="left: 23.9946px; right: auto; top: 16501px;"><li class="kd-menulistitem" value="id" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="id" track-metadata-original-language="zh-cn" track-metadata-selected-language="id">
            Bahasa Indonesia
          </li><li class="kd-menulistitem" value="de" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="de" track-metadata-original-language="zh-cn" track-metadata-selected-language="de">
            Deutsch
          </li><li class="kd-menulistitem" value="en" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="en" track-metadata-original-language="zh-cn" track-metadata-selected-language="en">
            English
          </li><li class="kd-menulistitem" value="es" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="es" track-metadata-original-language="zh-cn" track-metadata-selected-language="es">
            español
          </li><li class="kd-menulistitem" value="fr" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="fr" track-metadata-original-language="zh-cn" track-metadata-selected-language="fr">
            français
          </li><li class="kd-menulistitem" value="pt-br" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="pt-br" track-metadata-original-language="zh-cn" track-metadata-selected-language="pt-br">
            Português Brasileiro
          </li><li class="kd-menulistitem" value="ru" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="ru" track-metadata-original-language="zh-cn" track-metadata-selected-language="ru">
            Русский
          </li><li class="kd-menulistitem" value="ja" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="ja" track-metadata-original-language="zh-cn" track-metadata-selected-language="ja">
            日本語
          </li><li class="kd-menulistitem devsite-selected-option" value="zh-cn" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="zh-cn" track-metadata-original-language="zh-cn" track-metadata-selected-language="zh-cn">
            简体中文
          </li><li class="kd-menulistitem" value="ko" track-type="languageSelector" track-name="changed" track-metadata-eventdetail="ko" track-metadata-original-language="zh-cn" track-metadata-selected-language="ko">
            한국어
          </li></ul></body></html>